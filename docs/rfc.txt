Updated by:                                                  Meddi GUERAN
Roster LOL                                                  Jérémy BISSON
Request for Comments: 4242                                   Jérémy DELFINO
                                                             Luca GIGLIO
                                                             Alexandre VITTENET
                                                             Epitech Marseille
                                                            December 2024
Category: Standards Track
                            R-TYPE Protocol

Status of this Memo

This memo is the official specification of the R-TYPE protocol. Distribution
of this memo is unlimited.

Table of contents

    1. Introduction....................................................1
    2. R-TYPE Network Model.............................................2
    3. R-TYPE Protocol Commands........................................3
    4. R-TYPE Protocol Implementation..................................4
    5. Security and Performance Considerations.........................5

1. Introduction

    The R-TYPE is an online multiplayer game that requires real-time communication
    between clients and server. The protocol is built around binary-encoded
    actions using a 5-bit system, allowing for efficient packet transmission
    while maintaining readability through debug color coding.

    The protocol defines a set of specific actions that cover all game events
    from movement to power-up spawning. Each action can carry additional
    parameters as needed.

2. R-Type Network Model

    The server manages client connections through UDP endpoints, with each client
    being tracked in a ClientInfo structure containing:
        - Name (string)
        - Connection status (bool)
        - Endpoint information (IP:Port)

    Messages are encoded using a 5-bit binary system where each action is
    represented by a unique binary code. The message structure is:
        BINARY_CODE [ARGUMENT1] [ARGUMENT2] ...

    Example:
        "00001 playerID position" represents a SHOOT action

3. R-TYPE Protocol Commands

    The protocol defines the following actions:
    +---------------+------------+--------------------+
    | Action        | Binary     | Description       |
    +---------------+------------+--------------------+
    | NONE          | 0b0000     | No action         |
    | SHOOT         | 0b0001     | Player shoots     |
    | MOVE          | 0b0010     | Generic movement  |
    | DOWN          | 0b0011     | Move downward     |
    | LEFT          | 0b0100     | Move left         |
    | RIGHT         | 0b0101     | Move right        |
    | UP            | 0b0110     | Move upward       |
    | STOP          | 0b0111     | Stop movement     |
    | POWER_UP      | 0b1000     | Use power-up      |
    | POWER_UP_SPAWN| 0b1001     | Spawn power-up    |
    | RESPAWN       | 0b1010     | Player respawn    |
    | MOB_SPAWN     | 0b1011     | Spawn enemy       |
    | QUIT          | 0b1111     | Exit game         |
    | STOP_Y        | 0b10000    | Stop vertical     |
    | STOP_X        | 0b10001    | Stop horizontal   |
    | DEATH         | 0b10010    | Player death      |
    | COLLISION     | 0b10100    | Object collision  |
    | DISCONNECT    | 0b11011    | Client disconnect |
    | CONNECT       | 0b11111    | Client connect    |
    +---------------+------------+--------------------+

4. R-TYPE Protocol Implementation

    The server implementation uses boost::asio for network operations and
    runs on multiple threads:
    - Main thread for server management
    - Receive thread for handling incoming messages
    - Game logic thread for state updates

    Message handling follows this flow:
    1. Receive raw message from client
    2. Decode binary action code
    3. Parse additional arguments
    4. Process game action
    5. Broadcast updates to other clients

    Debug messages use color coding for better visibility:
    - GREEN: Server status messages
    - RED: Disconnection events
    - YELLOW: Connection events
    - BLUE: Action logging

5. Security and Performance Considerations

    The system implements several important features for game stability:
    - Thread-safe message handling
    - Asynchronous network operations
    - Binary encoding for reduced bandwidth
    - Broadcast optimization (sender excluded from broadcasts)
    - Comprehensive error handling
    - Debug logging system

    The UDP protocol was chosen for its low latency characteristics,
    essential for real-time gameplay. While it doesn't guarantee delivery,
    the game design accounts for potential packet loss through regular
    state updates and client-side prediction.